<template>
  <IonGrid>
    <IonCol>
      <p class="title">Import & see the imported emails, connections + your commission from their spending on LEN </p>
      <p>My dedicated invitation link to LEN to earn commission from their spending on LEN: https://www.londonentrepreneursnetwork.com</p>
      <IonRow class="importPaste">
        <IonCol class="importFrom">
          <p>Imports your emails from:</p>
          <IonRow>
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="40" height="40" alt="Excel" viewBox="0 0 48 48">
            <rect width="16" height="9" x="28" y="15" fill="#21a366"></rect><path fill="#185c37" d="M44,24H12v16c0,1.105,0.895,2,2,2h28c1.105,0,2-0.895,2-2V24z"></path><rect width="16" height="9" x="28" y="24" fill="#107c42"></rect><rect width="16" height="9" x="12" y="15" fill="#3fa071"></rect><path fill="#33c481" d="M42,6H28v9h16V8C44,6.895,43.105,6,42,6z"></path><path fill="#21a366" d="M14,6h14v9H12V8C12,6.895,12.895,6,14,6z"></path><path d="M22.319,13H12v24h10.319C24.352,37,26,35.352,26,33.319V16.681C26,14.648,24.352,13,22.319,13z" opacity=".05"></path><path d="M22.213,36H12V13.333h10.213c1.724,0,3.121,1.397,3.121,3.121v16.425	C25.333,34.603,23.936,36,22.213,36z" opacity=".07"></path><path d="M22.106,35H12V13.667h10.106c1.414,0,2.56,1.146,2.56,2.56V32.44C24.667,33.854,23.52,35,22.106,35z" opacity=".09"></path><linearGradient id="flEJnwg7q~uKUdkX0KCyBa_UECmBSgBOvPT_gr1" x1="4.725" x2="23.055" y1="14.725" y2="33.055" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#18884f"></stop><stop offset="1" stop-color="#0b6731"></stop></linearGradient><path fill="url(#flEJnwg7q~uKUdkX0KCyBa_UECmBSgBOvPT_gr1)" d="M22,34H6c-1.105,0-2-0.895-2-2V16c0-1.105,0.895-2,2-2h16c1.105,0,2,0.895,2,2v16	C24,33.105,23.105,34,22,34z"></path><path fill="#fff" d="M9.807,19h2.386l1.936,3.754L16.175,19h2.229l-3.071,5l3.141,5h-2.351l-2.11-3.93L11.912,29H9.526	l3.193-5.018L9.807,19z"></path>
            </svg>
          </a>
          <a href="#">
            <svg xmlns="http://www.w3.org/2000/svg" x="0px" y="0px" width="40" height="40" name="Outlook" viewBox="0 0 48 48">
            <path fill="#103262" d="M43.255,23.547l-6.81-3.967v11.594H44v-6.331C44,24.309,43.716,23.816,43.255,23.547z"></path><path fill="#0084d7" d="M13,10h10v9H13V10z"></path><path fill="#33afec" d="M23,10h10v9H23V10z"></path><path fill="#54daff" d="M33,10h10v9H33V10z"></path><path fill="#027ad4" d="M23,19h10v9H23V19z"></path><path fill="#0553a4" d="M23,28h10v9H23V28z"></path><path fill="#25a2e5" d="M33,19h10v9H33V19z"></path><path fill="#0262b8" d="M33,28h10v9H33V28z"></path><polygon points="13,37 43,37 43,24.238 28.99,32.238 13,24.238" opacity=".019"></polygon><polygon points="13,37 43,37 43,24.476 28.99,32.476 13,24.476" opacity=".038"></polygon><polygon points="13,37 43,37 43,24.714 28.99,32.714 13,24.714" opacity=".057"></polygon><polygon points="13,37 43,37 43,24.952 28.99,32.952 13,24.952" opacity=".076"></polygon><polygon points="13,37 43,37 43,25.19 28.99,33.19 13,25.19" opacity=".095"></polygon><polygon points="13,37 43,37 43,25.429 28.99,33.429 13,25.429" opacity=".114"></polygon><polygon points="13,37 43,37 43,25.667 28.99,33.667 13,25.667" opacity=".133"></polygon><polygon points="13,37 43,37 43,25.905 28.99,33.905 13,25.905" opacity=".152"></polygon><polygon points="13,37 43,37 43,26.143 28.99,34.143 13,26.143" opacity=".171"></polygon><polygon points="13,37 43,37 43,26.381 28.99,34.381 13,26.381" opacity=".191"></polygon><polygon points="13,37 43,37 43,26.619 28.99,34.619 13,26.619" opacity=".209"></polygon><polygon points="13,37 43,37 43,26.857 28.99,34.857 13,26.857" opacity=".229"></polygon><polygon points="13,37 43,37 43,27.095 28.99,35.095 13,27.095" opacity=".248"></polygon><polygon points="13,37 43,37 43,27.333 28.99,35.333 13,27.333" opacity=".267"></polygon><polygon points="13,37 43,37 43,27.571 28.99,35.571 13,27.571" opacity=".286"></polygon><polygon points="13,37 43,37 43,27.81 28.99,35.81 13,27.81" opacity=".305"></polygon><polygon points="13,37 43,37 43,28.048 28.99,36.048 13,28.048" opacity=".324"></polygon><polygon points="13,37 43,37 43,28.286 28.99,36.286 13,28.286" opacity=".343"></polygon><polygon points="13,37 43,37 43,28.524 28.99,36.524 13,28.524" opacity=".362"></polygon><polygon points="13,37 43,37 43,28.762 28.99,36.762 13,28.762" opacity=".381"></polygon><polygon points="13,37 43,37 43,29 28.99,37 13,29" opacity=".4"></polygon><linearGradient id="Qf7015RosYe_HpjKeG0QTa_ut6gQeo5pNqf_gr1" x1="38.925" x2="32.286" y1="24.557" y2="36.024" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#31abec"></stop><stop offset="1" stop-color="#1582d5"></stop></linearGradient><path fill="url(#Qf7015RosYe_HpjKeG0QTa_ut6gQeo5pNqf_gr1)" d="M15.441,42h26.563c1.104,0,1.999-0.889,2-1.994C44.007,35.485,44,24.843,44,24.843	s-0.007,0.222-1.751,1.212S14.744,41.566,14.744,41.566S14.978,42,15.441,42z"></path><linearGradient id="Qf7015RosYe_HpjKeG0QTb_ut6gQeo5pNqf_gr2" x1="13.665" x2="41.285" y1="6.992" y2="9.074" gradientUnits="userSpaceOnUse"><stop offset=".042" stop-color="#076db4"></stop><stop offset=".85" stop-color="#0461af"></stop></linearGradient><path fill="url(#Qf7015RosYe_HpjKeG0QTb_ut6gQeo5pNqf_gr2)" d="M43,10H13V8c0-1.105,0.895-2,2-2h26c1.105,0,2,0.895,2,2V10z"></path><linearGradient id="Qf7015RosYe_HpjKeG0QTc_ut6gQeo5pNqf_gr3" x1="28.153" x2="23.638" y1="33.218" y2="41.1" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#33acee"></stop><stop offset="1" stop-color="#1b8edf"></stop></linearGradient><path fill="url(#Qf7015RosYe_HpjKeG0QTc_ut6gQeo5pNqf_gr3)" d="M13,25v15c0,1.105,0.895,2,2,2h15h12.004c0.462,0,0.883-0.162,1.221-0.425L13,25z"></path><path d="M21.319,13H13v24h8.319C23.352,37,25,35.352,25,33.319V16.681C25,14.648,23.352,13,21.319,13z" opacity=".05"></path><path d="M21.213,36H13V13.333h8.213c1.724,0,3.121,1.397,3.121,3.121v16.425	C24.333,34.603,22.936,36,21.213,36z" opacity=".07"></path><path d="M21.106,35H13V13.667h8.106c1.414,0,2.56,1.146,2.56,2.56V32.44C23.667,33.854,22.52,35,21.106,35z" opacity=".09"></path><linearGradient id="Qf7015RosYe_HpjKeG0QTd_ut6gQeo5pNqf_gr4" x1="3.53" x2="22.41" y1="14.53" y2="33.41" gradientUnits="userSpaceOnUse"><stop offset="0" stop-color="#1784d8"></stop><stop offset="1" stop-color="#0864c5"></stop></linearGradient><path fill="url(#Qf7015RosYe_HpjKeG0QTd_ut6gQeo5pNqf_gr4)" d="M21,34H5c-1.105,0-2-0.895-2-2V16c0-1.105,0.895-2,2-2h16c1.105,0,2,0.895,2,2v16	C23,33.105,22.105,34,21,34z"></path><path fill="#fff" d="M13,18.691c-3.111,0-4.985,2.377-4.985,5.309S9.882,29.309,13,29.309	c3.119,0,4.985-2.377,4.985-5.308C17.985,21.068,16.111,18.691,13,18.691z M13,27.517c-1.765,0-2.82-1.574-2.82-3.516	s1.06-3.516,2.82-3.516s2.821,1.575,2.821,3.516S14.764,27.517,13,27.517z"></path>
            </svg>
          </a>
          <a href="#"><IonIcon class="linkedin-icon" size="large" :icon="logoLinkedin" /></a>
          <a href="#"><IonIcon class="google-icon" size="large" :icon="logoGoogle" /></a>
          <a href="#"><IonIcon class="facebook-icon" size="large" :icon="logoFacebook" /></a>
          <a href="#"><IonIcon class="twitter-icon" size="large" :icon="logoTwitter" /></a>
          <a href="#"><IonIcon class="yahoo-icon" size="large" :icon="logoYahoo" /></a>
        </IonRow></IonCol>

        <IonCol>
          <IonTextarea class="pasteEmailsHere" v-model="pasteEmailsHere"  label="OR; copy then 'Paste' your emails here" label-placement="floating" :counter="true" :auto-grow="true" :maxlength="500" />
        </IonCol>
      </IonRow>

      <IonRow class="displays">
        <IonCol>
          <IonSelect v-model="displayImportedFrom" placeholder="Display Imported Emails From" fill="outline">
            <IonSelectOption value="Gmail">Gmail</IonSelectOption>
            <IonSelectOption value="Yahoo">Yahoo</IonSelectOption>
            <IonSelectOption value="Outlook">Outlook</IonSelectOption>
            <IonSelectOption value="Excel">Excel</IonSelectOption>
            <IonSelectOption value="Facebook">Facebook</IonSelectOption>
            <IonSelectOption value="LinkedIn">LinkedIn</IonSelectOption>
            <IonSelectOption value="CopyPaste">CopyPaste</IonSelectOption>
          </IonSelect>
        </IonCol>

        <IonCol>
          <IonSelect v-model="displayMyConnections" placeholder="Display My Connections" fill="outline">
            <IonSelectOption value="Gmail">My Connections</IonSelectOption>
            <IonSelectOption value="Yahoo">Pending Connection Request To Me</IonSelectOption>
            <IonSelectOption value="Outlook">Pending Connection Request To Others</IonSelectOption>
          </IonSelect>
        </IonCol>
        <!-- this section is for the TABLE only -->
        <IonRow class="displayConnectionAndEmails">
          <EmailImportsTableComponent/>
        </IonRow>
      </IonRow>
    </IonCol>
  </IonGrid>
</template>



<script lang="ts">
import { defineComponent, ref } from 'vue';
import { IonCard, IonButton, IonCol, IonGrid, IonIcon, IonRow, IonTextarea, IonSelect, IonSelectOption } from '@ionic/vue';
import { logoFacebook, logoTwitter, logoGoogle, logoLinkedin, logoYahoo } from 'ionicons/icons';
import EmailImportsTableComponent from '@/components/MyConnectionComponents/EmailImportsTableComponent.vue';

// Function to sanitize input
const sanitizeInput = (input: string): string => {
  return input
    .replace(/<script.*?>.*?<\/script>/gi, '')  // Remove script tags
    .replace(/<[\/\!]*?[^<>]*?>/gi, '')       // Remove HTML tags
    .replace(/&(?:lt|gt|amp|quot|#39);/g, '') // Remove HTML entities
    .replace(/[<>\/\\'";]/g, '');              // Remove potentially harmful characters
};

export default defineComponent({
  name: 'MyConnectionComponent',
  components: {
    IonCard, 
    IonButton,
    IonCol,
    IonGrid,
    IonRow,
    IonIcon,
    IonTextarea,
    IonSelect,
    IonSelectOption,
    EmailImportsTableComponent,
  },
  setup() {
    const pasteEmailsHere = ref<string>('');
    const displayImportedFrom = ref<string | null>(null);
    const displayMyConnections = ref<string | null>(null);

    const submitContent = () => {
      // Sanitize all text fields
      const sanitizedData = {
        displayImportedFrom: sanitizeInput(displayImportedFrom.value ?? ''),
        pasteEmailsHere: sanitizeInput(pasteEmailsHere.value).substring(0, 10000),
      };
      console.log('Form Data:', sanitizedData);
      // Here you should send sanitizedData to your API endpoint
    };

    return {
      pasteEmailsHere,
      displayImportedFrom,
      displayMyConnections,
      logoFacebook,
      logoTwitter,
      logoGoogle,
      logoLinkedin,
      logoYahoo,
      submitContent,
    };
  },
});
</script>



<style scoped>
  ion-grid {
    overflow-y: auto;     /* Enable vertical scrolling */
    height: 100%;     /* Full height to fit the parent */
  }
  .title {
    text-align: center;
    font-weight: bold;
  }
  a {
    padding: 4px;

  }
  .image {
    display: flex;
    justify-content: center;
  }
  /* Social media icon colors */
  .linkedin-icon {
    color: #0077b5; /* LinkedIn blue */
  }
  .google-icon {
    color: #db4437; /* Google red */
  }
  .facebook-icon {
    color: #3b5998; /* Facebook blue */
  }
  .twitter-icon {
    color: #1da1f2; /* Twitter blue */
  }
  .yahoo-icon {
    color: #720e9e; /* Yahoo purple */
  }

  .pasteEmailsHere,
  .importFrom {
    width: 100%;
    height: 100px; /* Adjust as needed */
    border: solid 1px gray;
    border-radius: 7px;
    margin-bottom: 30px;
    /* overflow: wrap;
    white-space: wrap; */
  }
  .displayConnectionAndEmails {
    overflow-y: auto;
    width: 100%; /* ensures the box is displayed*/
    border-radius: 9px;
  }

    
  @media (max-width: 650px) {

    .importFrom {
      min-width: 100%;
    }

  }
</style>

